<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pang</title>

    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>
<div class="wrapper d-flex align-items-stretch">
    <nav id="sidebar" class="active">
        <div class="p-4 pt-5">
            <a href="#" class="img logo rounded-circle mb-5"
               style="background-image: url(../static/images/pang.png);"></a>
            <ul class="list-unstyled components mb-5">
                <li class="active">
                    <a href="#side_menu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">쇼핑 검색
                        순위</a>

                    <ul class="collapse list-unstyled" id="side_menu">
                        {% for key, value in key_word_list.items() %}
                        <li>
                            <a onclick='show_content("{{ key }}", "{{ value }}")' href="#">
                                {{ key }}
                            </a>
                        </li>
                        {% endfor%}
                    </ul>
                </li>
                <!--                <li>-->
                <!--                    <a href="#">About</a>-->
                <!--                </li>-->
                <!--                <li>-->
                <!--                    <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false"-->
                <!--                       class="dropdown-toggle">Pages</a>-->
                <!--                    <ul class="collapse list-unstyled" id="pageSubmenu">-->
                <!--                        <li>-->
                <!--                            <a href="#">Page 1</a>-->
                <!--                        </li>-->
                <!--                        <li>-->
                <!--                            <a href="#">Page 2</a>-->
                <!--                        </li>-->
                <!--                        <li>-->
                <!--                            <a href="#">Page 3</a>-->
                <!--                        </li>-->
                <!--                    </ul>-->
                <!--                </li>-->
                <!--                <li>-->
                <!--                    <a href="#">Portfolio</a>-->
                <!--                </li>-->
                <!--                <li>-->
                <!--                    <a href="#">Contact</a>-->
                <!--                </li>-->
            </ul>

            <div class="footer">
                <p>
                    <a href="https://blog.naver.com/apangd">블로그</a>
                </p>
                <p>
                    <a href="https://partners.coupang.com/">쿠팡 파트너스</a>
                </p>
                <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                    Copyright &copy;<script>document.write(new Date().getFullYear());</script>
                    All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a
                            href="https://colorlib.com" target="_blank">Colorlib.com</a>
                    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
            </div>

        </div>
    </nav>

    <!-- Page Content  -->
    <div id="content" class="p-4 p-md-5">
        <!--        <nav class="navbar navbar-expand-lg navbar-light bg-light">-->
        <!--            <div class="container-fluid">-->

        <!--                <button type="button" id="sidebarCollapse" class="btn btn-primary">-->
        <!--                    <i class="fa fa-bars"></i>-->
        <!--                    <span class="sr-only">Toggle Menu</span>-->
        <!--                </button>-->
        <!--                <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse"-->
        <!--                        data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"-->
        <!--                        aria-expanded="false" aria-label="Toggle navigation">-->
        <!--                    <i class="fa fa-bars"></i>-->
        <!--                </button>-->

        <!--                <div class="collapse navbar-collapse" id="navbarSupportedContent">-->
        <!--                    <ul class="nav navbar-nav ml-auto">-->
        <!--                        <li class="nav-item active">-->
        <!--                            <a class="nav-link" href="#">Home</a>-->
        <!--                        </li>-->
        <!--                        <li class="nav-item">-->
        <!--                            <a class="nav-link" href="#">About</a>-->
        <!--                        </li>-->
        <!--                        <li class="nav-item">-->
        <!--                            <a class="nav-link" href="#">Portfolio</a>-->
        <!--                        </li>-->
        <!--                        <li class="nav-item">-->
        <!--                            <a class="nav-link" href="#">Contact</a>-->
        <!--                        </li>-->
        <!--                    </ul>-->
        <!--                </div>-->
        <!--            </div>-->
        <!--        </nav>-->

        <!--          Contents-->
        <h2 id="main-title" class="mb-4">포스팅 정보</h2>
        <hr>

        <div id="card_contents" class="row">

        </div>

        <div class="row">
            <div class="col-12">
                <p><br><br><br>[x월 x째주] Top 5 - "xxx"<br>x월 x째주 "xxx" Top10 추천 드립니다. <br> 좋은 쇼핑 되시기 바랍니다 :) </p>
            </div>
            <div id="posting" class="col-12">

            </div>

            <div class="col-12">
                <p><br><br><br>행복한 하루 되세요! <br><br><br> "쿠팡 파트너스 활동을 통해 일정액의 수수료를 제공받을 수 있습니다" </p>
            </div>
        </div>
    </div>
</div>

<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<!--<script src="../static/js/jquery.min.js"></script>-->
<script src="../static/js/popper.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="../static/js/main.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $('#Progress_Loading').hide(); //첫 시작시 로딩바를 숨겨준다.
    })
        .ajaxStart(function () {
            $('#Progress_Loading').show(); //ajax실행시 로딩바를 보여준다.
        })
        .ajaxStop(function () {
            $('#Progress_Loading').hide(); //ajax종료시 로딩바를 숨겨준다.
        });

    function show_content(key, values) {
        // content reset
        const card_contents = document.getElementById("card_contents");
        while ( card_contents.hasChildNodes() ) { card_contents.removeChild( card_contents.firstChild ); }
        const posting = document.getElementById("posting");
        while ( posting.hasChildNodes() ) { posting.removeChild( posting.firstChild ); }

        document.getElementById("main-title").innerText = key.concat(" 포스팅 정보")

        $.ajax({
            url: "/foo",
            type: "POST",
            contentType: "text/plain",
            data: values,
            success: function (response) {
                const obj = JSON.parse(response);
                console.log(obj.length)
                for (let i = 0; i < obj.length; i++) {
                    create_card(i, obj[i].title, obj[i].link)
                }
            }
        });
    }

    function create_card(i, title, link) {
        const card_content = document.getElementById("card_contents");
        const div0 = document.createElement("div");
        div0.className = "col-6 card_content"

        const div1 = document.createElement("div");
        div1.className = "m-2"

        const div2 = document.createElement("div");
        div2.className = "card card-custom"

        const img = document.createElement("img");
        img.className = "card-img-top"
        img.src = "http://222.99.121.13/resource/screenshot".concat(i, ".png");

        const div3 = document.createElement("div");
        div3.className = "card-body"

        const h5 = document.createElement("h5");
        h5.className = "card-title"
        h5.innerText = title

        const p = document.createElement("p")
        p.className = "card-text"
        p.innerText = link

        //<a href="#" class="btn btn-primary">Go somewhere</a>

        div3.appendChild(h5)
        div3.appendChild(p)

        div2.appendChild(img)
        div2.appendChild(div3)

        div1.appendChild(div2)
        div0.appendChild(div1)

        card_content.appendChild(div0)


        // direct posting
        const posting = document.getElementById("posting");
        const _title = "Top[".concat(i + 1, "] - ", title);
        const _h5 = document.createElement("h5")
        _h5.innerText = _title;
        const _img = document.createElement("img")
        _img.src = "http://222.99.121.13/resource/screenshot".concat(i, ".png");
        const _p = document.createElement("p")
        _p.innerText = link
        posting.appendChild(document.createElement("br"))
        posting.appendChild(document.createElement("br"))
        posting.appendChild(_h5)
        posting.appendChild(_img)
        posting.appendChild(_p)
        posting.appendChild(document.createElement("br"))
    }
</script>
</body>

<div id="Progress_Loading"><!-- 로딩바 -->
    <img class="gif" src="../static/resource/loading.gif"/>
</div>

<style type="text/css"> <!--
로딩바스타일

-->
body {
    text-align: center;
    margin: 0 auto;
}

#Progress_Loading {
    position: absolute;
    left: 30%;
    top: 40%;
    background: #ffffff;
}

.gif {
    background-color: transparent;
    border-width: 0;
    border-radius: 0;
}
</style>
</html>

<!--<div class="col-6">-->
<!--   <div class="card card-custom">-->
<!--       <img class="card-img-top" src="../static/images/pang.png" alt="Card image cap">-->
<!--       <div class="card-body">-->
<!--           <h5 class="card-title">Card title</h5>-->
<!--           <p class="card-text">Some quick example text to build on the card title and make up the bulk of-->
<!--               the card's content.</p>-->
<!--           <a href="#" class="btn btn-primary">Go somewhere</a>-->
<!--       </div>-->
<!--   </div>-->
<!--</div>-->